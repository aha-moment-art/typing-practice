<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TypePlay - Practice What Matters</title>
  <style>
    :root {
      --primary-purple: #a882e0;
      --primary-purple-dark: #8f6ed1;
      --accent-beige-bg: #fdfaf0;
      --accent-beige-border: #e3d5aa;
      --light-gray-bg: #f4f4f4;
      --cartoon-bg: #fff9e6;
      --cartoon-border: #f4c542;
      --cartoon-shadow: #ffec99;
      --highlight-bg: #e7d4f7;
    }

    * { box-sizing: border-box; }

    body {
      font-family: Arial, sans-serif;
      background-color: var(--light-gray-bg);
      color: #333;
      margin: 0;
      padding: 2rem;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      position: relative;
    }

    .container {
      max-width: 900px;
      width: 100%;
      background-color: #ffffff;
      border-radius: 1rem;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.05);
      padding: 2rem;
    }

    h1 {
      text-align: center;
      color: #5a478f;
      margin-bottom: 2rem;
    }

    textarea {
      width: 100%;
      height: 100px;
      padding: 1rem;
      font-size: 1rem;
      border: 2px solid var(--accent-beige-border);
      border-radius: 0.5rem;
      background-color: var(--accent-beige-bg);
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
      resize: vertical;
      margin-bottom: 1rem;
    }

    textarea:focus {
      outline: none;
      border-color: var(--primary-purple);
      background-color: #fffef9;
    }

    .typing-input {
      width: 100%;
      padding: 1rem;
      font-size: 1rem;
      border: 2px solid var(--accent-beige-border);
      border-radius: 0.5rem;
      background-color: var(--accent-beige-bg);
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
      transition: border-color 0.3s ease, background-color 0.3s ease;
    }

    .typing-input:focus {
      outline: none;
      border-color: var(--primary-purple);
      background-color: #fffef9;
    }

    .typing-input.wrong {
      border-color: red !important;
      background-color: #ffe5e5 !important;
    }

    #practiceArea {
      margin-top: 2rem;
    }

    .sentence-block {
      margin-bottom: 1.5rem;
    }

    .sentence {
      margin-bottom: 0.5rem;
      font-size: 1.2rem;
    }

    .highlight {
      background-color: var(--highlight-bg);
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>TypePlay - Practice What Matters</h1>
    <textarea id="sourceText" placeholder="Enter your sentence here...">This is a typing practice sentence.</textarea>
    <button onclick="startPractice()">Start Practice</button>

    <div id="practiceArea"></div>

    <audio id="errorSound" src="error.mp3" preload="auto"></audio>
  </div>

  <script>
    function startPractice() {
      const practiceArea = document.getElementById('practiceArea');
      const sentence = document.getElementById('sourceText').value.trim();
      practiceArea.innerHTML = ''; // 清空

      const block = document.createElement('div');
      block.className = 'sentence-block';

      const sentenceDiv = document.createElement('div');
      sentenceDiv.className = 'sentence';

      // 每个字母包成一个 span
      sentence.split('').forEach(char => {
        const span = document.createElement('span');
        span.textContent = char;
        sentenceDiv.appendChild(span);
      });

      const input = document.createElement('input');
      input.type = 'text';
      input.className = 'typing-input';
      input.placeholder = 'Start typing here...';

      input.addEventListener('input', () => {
        const spans = sentenceDiv.querySelectorAll('span');
        const value = input.value;
        let hasError = false;

        spans.forEach((span, i) => {
          if (value[i] == null) {
            span.classList.remove('highlight');
          } else if (value[i] === span.textContent) {
            span.classList.add('highlight');
          } else {
            span.classList.remove('highlight');
            hasError = true;
          }
        });

        if (hasError) {
          input.classList.add('wrong');
          document.getElementById('errorSound').play();
        } else {
          input.classList.remove('wrong');
        }
      });

      block.appendChild(sentenceDiv);
      block.appendChild(input);
      practiceArea.appendChild(block);
    }
  </script>
</body>
</html>
